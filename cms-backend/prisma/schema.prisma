// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// User Management
model User {
  id        Int      @id @default(autoincrement())
  username  String   @unique
  email     String   @unique
  password  String
  role      UserRole @default(EDITOR)
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  createdProjects    Project[]    @relation("ProjectCreator")
  createdBlogPosts   BlogPost[]   @relation("BlogPostCreator")
  createdTeamMembers TeamMember[] @relation("TeamMemberCreator")
  createdMedia       Media[]      @relation("MediaCreator")

  @@map("users")
}

enum UserRole {
  ADMIN
  EDITOR
  VIEWER
}

// Projects Management
model Project {
  id                Int             @id @default(autoincrement())
  title_en          String
  title_ko          String?
  description_en    String          @db.Text
  description_ko    String?         @db.Text
  shortDesc_en      String?
  shortDesc_ko      String?
  category          ProjectCategory
  status            ProjectStatus   @default(ACTIVE)
  location_en       String?
  location_ko       String?
  startDate         DateTime?
  endDate           DateTime?
  budget            Decimal?        @db.Decimal(15, 2)
  clientName_en     String?
  clientName_ko     String?
  technologies      String?         @db.Text // JSON array of technologies
  features_en       String?         @db.Text
  features_ko       String?         @db.Text
  challenges_en     String?         @db.Text
  challenges_ko     String?         @db.Text
  results_en        String?         @db.Text
  results_ko        String?         @db.Text
  projectUrl        String?
  githubUrl         String?
  isPublished       Boolean         @default(true)
  isFeatured        Boolean         @default(false)
  sortOrder         Int             @default(0)
  seoTitle_en       String?
  seoTitle_ko       String?
  seoDescription_en String?
  seoDescription_ko String?
  createdBy         Int
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt

  // Relations
  creator User    @relation("ProjectCreator", fields: [createdBy], references: [id])
  media   Media[] @relation("ProjectMedia")

  @@map("projects")
}

enum ProjectCategory {
  MOBILE_APP
  WEB_APPLICATION
  ENTERPRISE_SOFTWARE
  ECOMMERCE
  CONSULTING
  INFRASTRUCTURE
  AI_ML
  BLOCKCHAIN
  OTHER
}

enum ProjectStatus {
  PLANNING
  IN_PROGRESS
  COMPLETED
  ON_HOLD
  CANCELLED
  ACTIVE
}

// Blog Posts
model BlogPost {
  id                Int       @id @default(autoincrement())
  title_en          String
  title_ko          String?
  slug_en           String    @unique
  slug_ko           String?
  excerpt_en        String?   @db.Text
  excerpt_ko        String?   @db.Text
  content_en        String    @db.LongText
  content_ko        String?   @db.LongText
  category          String
  tags              String?   @db.Text // JSON array of tags
  isPublished       Boolean   @default(false)
  isFeatured        Boolean   @default(false)
  publishedAt       DateTime?
  readingTime       Int?      // in minutes
  viewCount         Int       @default(0)
  seoTitle_en       String?
  seoTitle_ko       String?
  seoDescription_en String?
  seoDescription_ko String?
  createdBy         Int
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt

  // Relations
  creator User    @relation("BlogPostCreator", fields: [createdBy], references: [id])
  media   Media[] @relation("BlogPostMedia")

  @@map("blog_posts")
}

// Team Members
model TeamMember {
  id             Int     @id @default(autoincrement())
  name_en        String
  name_ko        String?
  position_en    String
  position_ko    String?
  department_en  String?
  department_ko  String?
  bio_en         String? @db.Text
  bio_ko         String? @db.Text
  email          String?
  phone          String?
  linkedinUrl    String?
  githubUrl      String?
  twitterUrl     String?
  skills         String? @db.Text // JSON array of skills
  experience     Int?    // years of experience
  education_en   String? @db.Text
  education_ko   String? @db.Text
  languages      String? @db.Text // JSON array of languages
  isActive       Boolean @default(true)
  isFeatured     Boolean @default(false)
  joinDate       DateTime?
  sortOrder      Int     @default(0)
  profileImageId Int?
  createdBy      Int
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  // Relations
  creator      User   @relation("TeamMemberCreator", fields: [createdBy], references: [id])
  profileImage Media? @relation("TeamMemberProfile", fields: [profileImageId], references: [id])

  @@map("team_members")
}

// Media/File Management
model Media {
  id           Int       @id @default(autoincrement())
  filename     String
  originalName String
  mimeType     String
  size         Int
  path         String
  url          String
  altText_en   String?
  altText_ko   String?
  caption_en   String?
  caption_ko   String?
  category     MediaType @default(IMAGE)
  isPublic     Boolean   @default(true)
  uploadedBy   Int
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  // Relations
  uploader         User         @relation("MediaCreator", fields: [uploadedBy], references: [id])
  projectMedia     Project[]    @relation("ProjectMedia")
  blogPostMedia    BlogPost[]   @relation("BlogPostMedia")
  teamMemberProfile TeamMember[] @relation("TeamMemberProfile")

  @@map("media")
}

enum MediaType {
  IMAGE
  VIDEO
  DOCUMENT
  AUDIO
  OTHER
}

// Site Settings
model SiteSetting {
  id       Int    @id @default(autoincrement())
  key      String @unique
  value_en String @db.Text
  value_ko String? @db.Text
  category String @default("general")
  isPublic Boolean @default(true)
  updatedAt DateTime @updatedAt

  @@map("site_settings")
}

// Header/Navigation Management
model NavigationItem {
  id         Int     @id @default(autoincrement())
  label_en   String
  label_ko   String?
  url        String
  parentId   Int?
  sortOrder  Int     @default(0)
  isActive   Boolean @default(true)
  target     String  @default("_self") // _self, _blank
  cssClass   String?
  icon       String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  // Self-relation for parent/child menu items
  parent   NavigationItem?  @relation("MenuHierarchy", fields: [parentId], references: [id])
  children NavigationItem[] @relation("MenuHierarchy")

  @@map("navigation_items")
}

// Contact Information
model ContactInfo {
  id              Int     @id @default(autoincrement())
  type            String  // "korea_office", "india_office", "general"
  companyName_en  String?
  companyName_ko  String?
  address_en      String? @db.Text
  address_ko      String? @db.Text
  phone           String?
  email           String?
  website         String?
  mapUrl          String?
  latitude        Decimal? @db.Decimal(10, 7)
  longitude       Decimal? @db.Decimal(10, 7)
  workingHours_en String?
  workingHours_ko String?
  isActive        Boolean @default(true)
  sortOrder       Int     @default(0)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@map("contact_info")
}

// Translation Queue (for auto-translation)
model TranslationQueue {
  id          Int               @id @default(autoincrement())
  contentType String            // "project", "blog_post", "team_member", etc.
  contentId   Int
  fieldName   String            // "title", "description", etc.
  sourceText  String            @db.Text
  targetLang  String            @default("ko")
  status      TranslationStatus @default(PENDING)
  translatedText String?        @db.Text
  service     String?           // "libretranslate", "google", etc.
  errorMessage String?          @db.Text
  attempts    Int               @default(0)
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt

  @@map("translation_queue")
}

enum TranslationStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  FAILED
  SKIPPED
}